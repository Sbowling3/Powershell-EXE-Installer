# Get all local users ending with .adm
$admUsers = Get-LocalUser | Where-Object { $_.Name -like "*.adm" } | Select-Object -ExpandProperty Name

# Loop through each user and apply the lgpo command
foreach ($user in $admUsers) {
    $command = "lgpo /u:$user 'Media Control\Block_ALL.pol'"
    Write-Host "Executing: $command"
    Invoke-Expression $command
}

# Run gpupdate to apply the policy changes
Write-Host "Updating group policies..."
gpupdate /force
